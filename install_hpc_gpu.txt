############
# DIFA OPH #
############

1. LOAD PYTHON 3.10

module purge
module load astro/python/3.10.0

2. CREATE VIRTUAL ENV AND ACTIVATE IT

mkdir virtual_env
python -m venv "virtual_env/chimera-gw"
source virtual_env/chimera-gw/bin/activate

3. INSTALL mpi4pi LINKED TO openmpi LIBRARIES ALREADY INSTALLED. YOU MAY NEED A SLURM SCRIPT FOR THIS

module load astro/gcc/10.3.0
module load mpi/openmpi/4.1.4

MPICC=$(which mpicc) pip install --no-cache-dir mpi4py>=4.0

# If you want to check the installation do:

python -m mpi4py --mpi-lib-version
ldd $(python -m mpi4py --prefix)/MPI.*.so

4. INSTALL everything else, including mpi4jax

pip install wheel
pip install cython
pip install numpy
pip install packaging
pip install tqdm
pip install jax
pip install mpi4jax --no-build-isolation
pip install equinox
pip install plum-dispatch
pip install emcee
pip install h5py
pip install healpy
pip install schwimmbad
pip install numba
pip install dill
pip install interpax
pip install matplotlib

5. Clone repo and use `sys.path.append'

############
# LEONARDO #
############

1. LOAD PYTHON 3.10

module load python/3.10.8--gcc--8.5.0

2. CREATE VIRTUAL ENVIRONMENT AND ACTIVATE IT

mkdir virtual_env
python -m venv "virtual_env/chimera-gw"
source virtual_env/chimera-gw/bin/activate

3. INSTALL mpi4pi LINKED TO openmpi LIBRARIES ALREADY INSTALLED

module load openmpi/4.1.6--gcc--12.2.0
module load cuda/12.2

MPICC=$(which mpicc) pip install --no-cache-dir mpi4py>=4.0

4. INSTALL everything else, including mpi4jax

pip install wheel
pip install cython
pip install numpy
pip install packaging
pip install tqdm
pip install "jax[cuda12]"
pip install mpi4jax --no-build-isolation
pip install equinox
pip install plum-dispatch
pip install emcee
pip install healpy
pip install h5py
pip install schwimmbad
pip install numba
pip install dill
pip install interpax
pip install matplotlib

5. Clone repo and use `sys.path.append'

# micromamba install cython numpy packaging equinox plum-dispatch emcee healpy h5py schwimmbad numba interpax mpmath
micromamba install -c conda-forge gcc_linux-64 gxx_linux-64

# pip install mpi4jax --no-build-isolation
# micromamba install
